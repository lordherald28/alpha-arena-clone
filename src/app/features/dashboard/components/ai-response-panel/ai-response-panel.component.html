<div class="panel">
  <h3>An치lisis de Trading - Zion Capital</h3>
  @if (aiResponseHist().length > 0) {
  @for (item of aiResponseHist(); track item) {
  <details class="trade-card">
    <summary class="trade-summary">
      <div class="trade-header">
        <span class="decision-badge" [class]="item.decision.toLowerCase()">
          {{ item.decision }}
        </span>
        <span class="confidence-badge">
          {{ (item.confidence).toFixed(1) }}%
        </span>
        <span class="timestamp">
          {{ date | date:'HH:mm' }}
        </span>
      </div>
      <div class="strategy-info">
        <small>{{ item.rawJson?.selected_strategy || 'ANALYSIS' }}</small>
      </div>
    </summary>

    <div class="trade-details">
      <div class="reason-section">
        <strong>An치lisis:</strong>
        <p class="reason-text">{{ item.reason }}</p>
      </div>

      <details class="json-section">
        <summary class="json-summary">Ver JSON t칠cnico</summary>
        <pre class="json-code">{{ item.rawJson | json }}</pre>
      </details>

      @if (item.rawJson?.risk_parameters) {
      <div class="risk-info">
        <strong>Gesti칩n de Riesgo:</strong>
        <div class="risk-grid">
          <span>Size: ${{ item.rawJson.risk_parameters.position_size_usdt }}</span>
          <span>SL: {{ item.rawJson.risk_parameters.stop_loss_percent }}%</span>
          <span>TP: {{ item.rawJson.risk_parameters.take_profit_percent }}%</span>
        </div>
      </div>
      }
    </div>
  </details>
  }
  } @else {
  <div class="empty-state">
    <p>游댃 Esperando an치lisis del mercado...</p>
  </div>
  }
</div>